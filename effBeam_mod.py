from herschel.spire.all import *
from herschel.spire.util import *
from herschel.ia.all import *
from herschel.ia.task.mode import *
from herschel.ia.pg import ProductSink
from java.lang import *
from java.util import *
from os.path import join as pjoin
import herschel.spire.ia.pipeline.common.util
import math
import os
from os.path import join as pj
import sys
from herschel.spire.ia.cal import SpireCalTask
from herschel.ia.numeric.toolbox.interp import CubicSplineInterpolator

sys.path.append("/data/Herschel/Calibration/RelGains/Code")
#cal = spireCal(jarFile='/home/chris/dp_spire/cal/spire_cal_11_0.jar')

def readBeams(fromFile=True,maxRad=600,inpPath=''):
	#from herschel.spire.all import *
	#from herschel.spire.util import *
	#from herschel.ia.all import *
	#from herschel.ia.task.mode import *
	#from java.lang import *
	#from java.util import *
	#import herschel.spire.ia.pipeline.common.util
	
	from herschel.ia.toolbox.util import AsciiTableReaderTask

	if inpPath=='':
		inpPath='/data/Herschel/Calibration/Inputs/'
	if inpPath[-1] != '/':
		inpPath=inpPath+'/'
	print inpPath
	bands=['PSW','PMW','PLW']
	radArr=Double1d.range(maxRad)
	print min(radArr),max(radArr)
	beams={'radius':radArr}
	beams['nrad']=len(radArr)
	beamBands={}

	for band in bands:
		##READ FROM FILES
		#fileCore=inpPath+band+'_Core.csv'
		#fileConst=inpPath+band+'_Constant.csv'
		#beamCore=asciiTableReader(file=fileCore, tableType='CSV')
		#print 'beamCore read:',beamCore
		#beamConst=asciiTableReader(file=fileConst, tableType='CSV')['c0'].data[0:maxRad]
		#print 'beamCore read'

		##HARDCODE
		if band=='PSW':
			beamCore=Float1d([1.0,0.98893,0.964846,0.93029,0.877115,0.811074,0.741589,0.667152,0.593808,0.51243,0.432562,0.362354,0.297574,0.237156,0.183598,0.141029,0.104555,0.0749299,0.0536539,0.0389037,0.0289943,0.0225245,0.0188906,0.0175117,0.0173261,0.0178729,0.0186153,0.0190912,0.0193184,0.0189755,0.0183258,0.0171415,0.0156918,0.0142585,0.0124451,0.0107319,0.00902788,0.00759845,0.00636128,0.00521037,0.00436658,0.00360037,0.0031047,0.00267879,0.00234648,0.00216825,0.00197853,0.00190962,0.00185903,0.00184408,0.00188888,0.00189716,0.00197046,0.0020097,0.00206681,0.00210566,0.00213495,0.00215275,0.00214342,0.00212,0.00207304,0.00200959,0.00192263,0.00182998,0.00172794,0.00160314,0.00148109,0.00135528,0.001244,0.00112075,0.00101204,9.09197E-4,8.30243E-4,7.43577E-4,6.71432E-4,6.15501E-4,5.62121E-4,5.25297E-4,4.8968E-4,4.64614E-4,4.48783E-4,4.32328E-4,4.22298E-4,4.10982E-4,4.01839E-4,3.93595E-4,3.8679E-4,3.77076E-4,3.71041E-4,3.60126E-4,3.47639E-4,3.4638E-4,3.31536E-4,3.25048E-4,3.14095E-4,3.04817E-4,2.98193E-4,2.87012E-4,2.84885E-4,2.74287E-4,2.70623E-4,2.63179E-4,2.55648E-4,2.57606E-4,2.47944E-4,2.47595E-4,2.3992E-4,2.3761E-4,2.36269E-4,2.30037E-4,2.28524E-4,2.23122E-4,2.2104E-4,2.17391E-4,2.13262E-4,2.10098E-4,2.06844E-4,2.03363E-4,2.00442E-4,1.95471E-4,1.91524E-4,1.86748E-4,1.8126E-4,1.77749E-4,1.73615E-4,1.6984E-4,1.6682E-4,1.6245E-4,1.5861E-4,1.56749E-4,1.54203E-4,1.51898E-4,1.50318E-4,1.48441E-4,1.46855E-4,1.44348E-4,1.42647E-4,1.42764E-4,1.40643E-4,1.41004E-4,1.37441E-4,1.36992E-4,1.36094E-4,1.34214E-4,1.34371E-4,1.30872E-4,1.29029E-4,1.26297E-4,1.22167E-4,1.21984E-4,1.17988E-4,1.18062E-4,1.13856E-4,1.10877E-4,1.08541E-4,1.04647E-4,1.02798E-4,9.95287E-5,9.65723E-5,9.43061E-5,9.17071E-5,9.03991E-5,8.86198E-5,8.6612E-5,8.57747E-5,8.24754E-5,8.05678E-5,7.91441E-5,7.74457E-5,7.62248E-5,7.47329E-5,7.28784E-5,7.07737E-5,6.98472E-5,6.7562E-5,6.6759E-5,6.58118E-5,6.40327E-5,6.23608E-5,6.12616E-5,6.08966E-5,5.95697E-5,5.77498E-5,5.58531E-5,5.50434E-5,5.48264E-5,5.32692E-5,5.23012E-5,5.11236E-5,4.99002E-5,4.92008E-5,4.69748E-5,4.6991E-5,4.57866E-5,4.4856E-5,4.37125E-5,4.16644E-5,4.2238E-5,4.0306E-5,4.00521E-5,4.01236E-5,3.94348E-5,4.00582E-5,3.85824E-5,3.87571E-5,3.87934E-5,3.85049E-5,3.9555E-5,3.90446E-5,4.02973E-5,3.98971E-5,3.94001E-5,3.90344E-5,3.92984E-5,3.92478E-5,3.88584E-5,3.86063E-5,3.85007E-5,3.75533E-5,3.79772E-5,3.60492E-5,3.54774E-5,3.48338E-5,3.35138E-5,3.34663E-5,3.27685E-5,3.20959E-5,3.07579E-5,3.02029E-5,2.93784E-5,2.91566E-5,2.82646E-5,2.69935E-5,2.61999E-5,2.5733E-5,2.58697E-5,2.58035E-5,2.5531E-5,2.56699E-5,2.55753E-5,2.50177E-5,2.54212E-5,2.48097E-5,2.54061E-5,2.5337E-5,2.51546E-5,2.61128E-5,2.52534E-5,2.58112E-5,2.50641E-5,2.43128E-5,2.47242E-5,2.29706E-5,2.3172E-5,2.21996E-5,2.14382E-5,2.19439E-5,2.09674E-5,2.11611E-5,2.04564E-5,2.0054E-5,1.92019E-5,1.88212E-5,1.80541E-5,1.79786E-5,1.77808E-5,1.71081E-5,1.66274E-5,1.62885E-5,1.52699E-5,1.55742E-5,1.48843E-5,1.41642E-5,1.43897E-5,1.35131E-5,1.39208E-5,1.3526E-5,1.32206E-5,1.36516E-5,1.2519E-5,1.32266E-5,1.2645E-5,1.29263E-5,1.33164E-5,1.24073E-5,1.30896E-5,1.26934E-5,1.32218E-5,1.29779E-5,1.27353E-5,1.30787E-5,1.26169E-5,1.27855E-5,1.30058E-5,1.34973E-5,1.31122E-5,1.31068E-5,1.29214E-5,1.26673E-5,1.3376E-5,1.32332E-5,1.35019E-5,1.31433E-5,1.32902E-5,1.29302E-5,1.22871E-5,1.27539E-5,1.1864E-5,1.1581E-5,1.0895E-5,1.14129E-5,1.12826E-5,1.09535E-5,1.09917E-5,1.01222E-5,1.02233E-5,9.97793E-6,9.58576E-6,9.96476E-6,9.678E-6,1.02042E-5,9.71457E-6,9.67113E-6,9.44864E-6,8.42446E-6,8.50892E-6,7.92741E-6,7.9383E-6,7.75998E-6,7.30736E-6,7.64746E-6,7.06032E-6,7.24853E-6,6.75396E-6,6.42998E-6,6.66211E-6,5.77311E-6,5.85757E-6,5.10572E-6,5.10011E-6,5.06034E-6,4.56472E-6,4.96105E-6,5.00302E-6,4.81205E-6,4.80475E-6,4.73699E-6,4.8406E-6,4.93244E-6,5.06264E-6,4.95134E-6,4.93533E-6,4.86175E-6,3.92779E-6,4.00545E-6,3.70442E-6,4.54463E-6,4.42917E-6,4.11438E-6,4.39447E-6,4.41909E-6,4.46299E-6,4.35074E-6,4.13094E-6,3.8776E-6,3.66877E-6,3.40619E-6,3.55502E-6,3.6388E-6,4.22991E-6,3.58824E-6,3.66503E-6,3.0989E-6,3.22294E-6,3.1631E-6,3.10452E-6,3.04719E-6,2.99106E-6,2.9361E-6,2.8823E-6,2.82962E-6,2.77804E-6,2.72754E-6,2.67807E-6,2.62963E-6,2.58219E-6,2.53573E-6,2.49022E-6,2.44564E-6,2.40197E-6,2.35918E-6,2.31727E-6,2.27621E-6,2.23597E-6,2.19655E-6,2.15791E-6,2.12006E-6,2.08296E-6,2.0466E-6,2.01096E-6,1.97603E-6,1.94179E-6,1.90823E-6,1.87533E-6,1.84308E-6,1.81146E-6,1.78046E-6,1.75006E-6,1.72025E-6,1.69103E-6,1.66237E-6,1.63426E-6,1.60669E-6,1.57966E-6,1.55314E-6,1.52713E-6,1.50162E-6,1.4766E-6,1.45204E-6,1.42796E-6,1.40433E-6,1.38114E-6,1.3584E-6,1.33608E-6,1.31417E-6,1.29268E-6,1.27159E-6,1.25089E-6,1.23057E-6,1.21063E-6,1.19106E-6,1.17185E-6,1.153E-6,1.13448E-6,1.11631E-6,1.09847E-6,1.08096E-6,1.06376E-6,1.04688E-6,1.0303E-6,1.01402E-6,9.9803E-7,9.82331E-7,9.66914E-7,9.51772E-7,9.36901E-7,9.22295E-7,9.07949E-7,8.93857E-7,8.80014E-7,8.66416E-7,8.53057E-7,8.39933E-7,8.2704E-7,8.14372E-7,8.01926E-7,7.89696E-7,7.77679E-7,7.65871E-7,7.54267E-7,7.42864E-7,7.31657E-7,7.20643E-7,7.09818E-7,6.99178E-7,6.88721E-7,6.78442E-7,6.68337E-7,6.58405E-7,6.4864E-7,6.39041E-7,6.29604E-7,6.20326E-7,6.11204E-7,6.02234E-7,5.93415E-7,5.84743E-7,5.76216E-7,5.6783E-7,5.59584E-7,5.51474E-7,5.43499E-7,5.35654E-7,5.27939E-7,5.20351E-7,5.12887E-7,5.05545E-7,4.98323E-7,4.91219E-7,4.8423E-7,4.77355E-7,4.70591E-7,4.63936E-7,4.57389E-7,4.50947E-7,4.44608E-7,4.38371E-7,4.32234E-7,4.26195E-7,4.20252E-7,4.14404E-7,4.08648E-7,4.02984E-7,3.97409E-7,3.91922E-7,3.86522E-7,3.81206E-7,3.75974E-7,3.70824E-7,3.65754E-7,3.60764E-7,3.55851E-7,3.51014E-7,3.46252E-7,3.41564E-7,3.36948E-7,3.32404E-7,3.27929E-7,3.23523E-7,3.19185E-7,3.14913E-7,3.10706E-7,3.06563E-7,3.02484E-7,2.98466E-7,2.94509E-7,2.90612E-7,2.86774E-7,2.82994E-7,2.7927E-7,2.75602E-7,2.7199E-7,2.68431E-7,2.64925E-7,2.61472E-7,2.5807E-7,2.54718E-7,2.51417E-7,2.48164E-7,2.44959E-7,2.41801E-7,2.38689E-7,2.35624E-7,2.32603E-7,2.29626E-7,2.26693E-7,2.23803E-7,2.20954E-7,2.18147E-7,2.15381E-7,2.12655E-7,2.09968E-7,2.0732E-7,2.04709E-7,2.02137E-7,1.99601E-7,1.97102E-7,1.94638E-7,1.92209E-7,1.89815E-7,1.87455E-7,1.85129E-7,1.82835E-7,1.80574E-7,1.78345E-7,1.76147E-7,1.7398E-7,1.71843E-7,1.69737E-7,1.67659E-7,1.65611E-7,1.63592E-7,1.616E-7,1.59636E-7,1.577E-7,1.5579E-7,1.53906E-7,1.52049E-7,1.50217E-7,1.4841E-7,1.46628E-7,1.44871E-7,1.43137E-7,1.41428E-7,1.39741E-7,1.38077E-7,1.36437E-7,1.34818E-7,1.33221E-7,1.31646E-7,1.30092E-7,1.28559E-7,1.27046E-7,1.25554E-7,1.24082E-7,1.2263E-7,1.21197E-7,1.19783E-7,1.18387E-7,1.17011E-7])
			beamConst=Float1d([3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.22294E-6,3.36233E-6,3.69644E-6,4.04821E-6,4.08834E-6,4.78447E-6,4.86904E-6,5.40131E-6,5.36769E-6,5.34546E-6,5.89786E-6,5.91672E-6,6.34323E-6,6.32606E-6,6.64559E-6,6.67256E-6,6.3625E-6,6.52559E-6,6.98654E-6,7.56354E-6,7.6381E-6,7.59844E-6,7.83882E-6,7.44749E-6,7.40462E-6,7.28356E-6,7.67383E-6,7.7211E-6,8.06341E-6,8.26563E-6,8.11657E-6,8.35274E-6,8.03998E-6,8.09667E-6,8.6551E-6,8.21787E-6,8.65007E-6,8.9015E-6,9.04804E-6,9.08149E-6,8.60013E-6,8.16831E-6,7.90264E-6,7.89198E-6,8.06157E-6,7.70389E-6,7.7063E-6,7.32048E-6,6.85602E-6,6.51579E-6,6.18525E-6,6.51248E-6,6.2832E-6,6.13316E-6,5.70888E-6,5.60108E-6,5.70742E-6,5.61309E-6,5.7544E-6,5.44713E-6,5.78366E-6,5.43691E-6,5.54067E-6,5.60475E-6,5.02287E-6,5.49138E-6,5.08392E-6,5.4838E-6,5.59261E-6,5.63318E-6,5.75319E-6,5.63306E-6,5.17928E-6,5.227E-6,4.8124E-6,5.21032E-6,5.51099E-6,5.87981E-6,5.96209E-6,6.24048E-6,6.91066E-6,6.49769E-6,6.99639E-6,7.04816E-6,7.26538E-6,7.34036E-6,6.73519E-6,6.97304E-6,6.40137E-6,5.87458E-6,5.47304E-6,4.88842E-6,4.7476E-6,4.29994E-6,4.18461E-6,4.02159E-6,3.94728E-6,3.871E-6,4.1423E-6,4.19933E-6,3.95452E-6,4.32885E-6,4.49611E-6,4.31165E-6,4.28924E-6,4.11357E-6,4.82652E-6,5.20361E-6,5.59178E-6,6.15001E-6,5.48541E-6,5.64009E-6,5.10021E-6,4.97269E-6,5.4097E-6,5.48176E-6,5.9728E-6,5.78955E-6,6.05867E-6,5.77404E-6,5.73853E-6,5.98806E-6,5.88651E-6,5.9109E-6,5.83966E-6,5.58342E-6,5.94056E-6,5.789E-6,5.95051E-6,5.87023E-6,5.75934E-6,5.24023E-6,4.56117E-6,4.24913E-6,3.61067E-6,3.47992E-6,3.22353E-6,3.09619E-6,2.93147E-6,2.20336E-6,1.89288E-6,1.42131E-6,1.08998E-6,4.41591E-7,1.91702E-7,1.06768E-7,-3.01116E-7,-5.21415E-7,-5.54899E-7,-3.2727E-7,-2.85957E-7,1.26782E-8,5.27415E-7,7.7958E-7,1.04934E-6,1.35345E-6,1.77359E-6,2.23342E-6,2.3964E-6,2.92592E-6,2.98357E-6,3.3935E-6,3.07697E-6,3.13049E-6,2.66828E-6,2.91589E-6,3.10966E-6,3.13263E-6,3.12448E-6,2.63591E-6,2.48765E-6,2.43122E-6,2.34273E-6,1.78984E-6,1.21898E-6,9.275E-7,4.65455E-7,-1.57147E-7,-3.25522E-7,-3.62622E-7,-4.2343E-7,-8.24892E-7,-9.53141E-7,-1.18077E-6,-1.30167E-6,-1.28415E-6,-1.41218E-6,-1.19502E-6,-9.80066E-7,-6.24069E-7,-2.26339E-7,-1.75852E-7,1.85679E-7,2.98212E-7,-6.72302E-8,1.07427E-7,-1.91753E-7,-1.26712E-7,2.29716E-8,1.37193E-7,3.10829E-7,5.70248E-7,5.32109E-7,3.18499E-7,1.9985E-7,3.85222E-8,2.76138E-7,4.59355E-7,6.60585E-7,2.41923E-7,3.50887E-7,4.22817E-7,3.28874E-7,5.69715E-7,6.1163E-7,8.79587E-7,7.43659E-7,8.9777E-7,8.90648E-7,7.50339E-7,1.28381E-6,1.15057E-6,1.70584E-6,1.91724E-6,1.87658E-6,2.10477E-6,2.16311E-6])
		elif band=='PMW':
			beamCore=Float1d([1.0,0.993548,0.980869,0.96208,0.931468,0.893504,0.852839,0.807335,0.759133,0.701492,0.642446,0.586559,0.530073,0.472019,0.414777,0.363884,0.312679,0.262169,0.218688,0.181726,0.149902,0.120231,0.093883,0.0726621,0.0562599,0.0424385,0.0318385,0.0243481,0.0191662,0.0157659,0.01396,0.0132511,0.0133078,0.0139022,0.0147559,0.015754,0.0165687,0.0172601,0.0177079,0.0177889,0.0176999,0.0171455,0.016564,0.0156736,0.0145679,0.0134919,0.0121591,0.0109793,0.00967571,0.00839352,0.00734298,0.00626946,0.00536221,0.00449195,0.00385149,0.0032547,0.0027267,0.00234394,0.00198274,0.00175204,0.00154408,0.00138141,0.00130946,0.00120858,0.00118907,0.00116861,0.00117618,0.00121526,0.00123725,0.00130426,0.00135604,0.00142163,0.00148917,0.00154907,0.00161882,0.00167262,0.00172649,0.00176821,0.00179938,0.00182411,0.00183236,0.00182973,0.00181467,0.00178661,0.00174924,0.0017067,0.00164235,0.00158393,0.00151235,0.00144377,0.0013645,0.00127932,0.00120295,0.00112038,0.00104146,9.69532E-4,8.97231E-4,8.31978E-4,7.65884E-4,7.05739E-4,6.52017E-4,6.02325E-4,5.66066E-4,5.18935E-4,4.84873E-4,4.54233E-4,4.30926E-4,4.08999E-4,3.88175E-4,3.72677E-4,3.58467E-4,3.47261E-4,3.37018E-4,3.29439E-4,3.23064E-4,3.1401E-4,3.09141E-4,3.02833E-4,2.97397E-4,2.91352E-4,2.83675E-4,2.77861E-4,2.7169E-4,2.65255E-4,2.60752E-4,2.55066E-4,2.48594E-4,2.43062E-4,2.35444E-4,2.30856E-4,2.25842E-4,2.19463E-4,2.17033E-4,2.11573E-4,2.09413E-4,2.04098E-4,1.9882E-4,1.96644E-4,1.91329E-4,1.90475E-4,1.84793E-4,1.82159E-4,1.78448E-4,1.73112E-4,1.71017E-4,1.67075E-4,1.65683E-4,1.6322E-4,1.58093E-4,1.55071E-4,1.50225E-4,1.47397E-4,1.42062E-4,1.37167E-4,1.34135E-4,1.31329E-4,1.28778E-4,1.26524E-4,1.23628E-4,1.20956E-4,1.18589E-4,1.14757E-4,1.13122E-4,1.11376E-4,1.10608E-4,1.08499E-4,1.06972E-4,1.06058E-4,1.03925E-4,1.03694E-4,1.02593E-4,1.02459E-4,1.0262E-4,1.00426E-4,9.97235E-5,9.87401E-5,9.85163E-5,9.77067E-5,9.42004E-5,9.31211E-5,9.11958E-5,9.06832E-5,8.87775E-5,8.67504E-5,8.66259E-5,8.51749E-5,8.35603E-5,8.20678E-5,8.07624E-5,7.91851E-5,7.96062E-5,7.80045E-5,7.94275E-5,7.86169E-5,7.78605E-5,7.74334E-5,7.71049E-5,7.94116E-5,7.8863E-5,7.74385E-5,7.88226E-5,7.90169E-5,8.1761E-5,8.16615E-5,8.24989E-5,8.33108E-5,8.35686E-5,8.44492E-5,8.26664E-5,8.32944E-5,8.26053E-5,8.19263E-5,7.94453E-5,7.93403E-5,7.76953E-5,7.6349E-5,7.35874E-5,7.19503E-5,6.98301E-5,6.82291E-5,6.44264E-5,6.13546E-5,5.87717E-5,5.62293E-5,5.32022E-5,5.10423E-5,4.84298E-5,4.60375E-5,4.30966E-5,3.9877E-5,3.83959E-5,3.60458E-5,3.37422E-5,3.09173E-5,2.91294E-5,2.80449E-5,2.73596E-5,2.72064E-5,2.76978E-5,2.74093E-5,2.68138E-5,2.65503E-5,2.50111E-5,2.59253E-5,2.56756E-5,2.61409E-5,2.61027E-5,2.47774E-5,2.59612E-5,2.52687E-5,2.59068E-5,2.68397E-5,2.49006E-5,2.50158E-5,2.4311E-5,2.35946E-5,2.35955E-5,2.14729E-5,1.97414E-5,1.86504E-5,1.75205E-5,1.57189E-5,1.49824E-5,1.40012E-5,1.36544E-5,1.22108E-5,1.03052E-5,9.6154E-6,7.89033E-6,6.68673E-6,5.93605E-6,4.73296E-6,3.32178E-6,2.85138E-6,2.59184E-6,2.82584E-6,2.231E-6,1.59062E-6,2.42282E-6,1.94276E-6,2.0741E-6,2.14288E-6,2.74692E-6,3.14145E-6,2.51502E-6,3.28374E-6,3.42974E-6,4.40511E-6,4.89018E-6,4.85306E-6,5.11566E-6,4.92241E-6,4.91761E-6,5.65903E-6,6.31041E-6,6.19199E-6,7.54047E-6,6.94774E-6,7.19709E-6,6.67447E-6,5.79712E-6,6.41518E-6,6.04608E-6,8.05971E-6,7.09333E-6,6.69671E-6,6.75832E-6,6.41516E-6,7.10781E-6,5.50387E-6,5.87262E-6,5.50746E-6,5.66604E-6,6.58791E-6,5.38197E-6,5.05606E-6,4.39056E-6,4.54873E-6,4.66012E-6,4.91203E-6,6.0016E-6,4.67866E-6,3.85128E-6,3.93021E-6,3.68992E-6,5.08677E-6,4.97854E-6,4.87294E-6,4.76989E-6,4.66932E-6,4.57117E-6,4.47537E-6,4.38186E-6,4.29058E-6,4.20146E-6,4.11445E-6,4.02949E-6,3.94654E-6,3.86552E-6,3.78641E-6,3.70914E-6,3.63366E-6,3.55994E-6,3.48792E-6,3.41756E-6,3.34882E-6,3.28165E-6,3.21602E-6,3.15189E-6,3.08921E-6,3.02795E-6,2.96808E-6,2.90956E-6,2.85235E-6,2.79642E-6,2.74174E-6,2.68828E-6,2.63601E-6,2.5849E-6,2.53492E-6,2.48604E-6,2.43823E-6,2.39147E-6,2.34573E-6,2.30099E-6,2.25723E-6,2.21441E-6,2.17252E-6,2.13153E-6,2.09142E-6,2.05217E-6,2.01376E-6,1.97617E-6,1.93938E-6,1.90337E-6,1.86813E-6,1.83362E-6,1.79985E-6,1.76678E-6,1.73441E-6,1.70271E-6,1.67167E-6,1.64128E-6,1.61151E-6,1.58237E-6,1.55382E-6,1.52586E-6,1.49847E-6,1.47165E-6,1.44537E-6,1.41962E-6,1.3944E-6,1.36969E-6,1.34548E-6,1.32176E-6,1.29851E-6,1.27573E-6,1.25341E-6,1.23153E-6,1.21008E-6,1.18906E-6,1.16846E-6,1.14827E-6,1.12847E-6,1.10906E-6,1.09003E-6,1.07138E-6,1.05309E-6,1.03515E-6,1.01756E-6,1.00032E-6,9.83405E-7,9.66818E-7,9.5055E-7,9.34594E-7,9.18943E-7,9.03591E-7,8.88532E-7,8.73758E-7,8.59265E-7,8.45046E-7,8.31095E-7,8.17407E-7,8.03975E-7,7.90796E-7,7.77862E-7,7.6517E-7,7.52714E-7,7.40489E-7,7.28491E-7,7.16714E-7,7.05155E-7,6.93808E-7,6.82669E-7,6.71734E-7,6.60998E-7,6.50459E-7,6.40111E-7,6.29951E-7,6.19974E-7,6.10178E-7,6.00558E-7,5.91111E-7,5.81834E-7,5.72723E-7,5.63774E-7,5.54985E-7,5.46352E-7,5.37872E-7,5.29543E-7,5.2136E-7,5.13322E-7,5.05424E-7,4.97666E-7,4.90043E-7,4.82554E-7,4.75194E-7,4.67963E-7,4.60858E-7,4.53875E-7,4.47013E-7,4.4027E-7,4.33642E-7,4.27128E-7,4.20726E-7,4.14433E-7,4.08248E-7,4.02168E-7,3.96191E-7,3.90315E-7,3.84539E-7,3.7886E-7,3.73277E-7,3.67788E-7,3.62391E-7,3.57084E-7,3.51865E-7,3.46734E-7,3.41688E-7,3.36726E-7,3.31846E-7,3.27047E-7,3.22327E-7,3.17684E-7,3.13118E-7,3.08626E-7,3.04209E-7,2.99863E-7,2.95588E-7,2.91382E-7,2.87245E-7,2.83175E-7,2.79171E-7,2.75231E-7,2.71354E-7,2.6754E-7,2.63787E-7,2.60094E-7,2.5646E-7,2.52884E-7,2.49365E-7,2.45902E-7,2.42493E-7,2.39138E-7,2.35837E-7,2.32587E-7,2.29389E-7,2.2624E-7,2.23141E-7,2.2009E-7,2.17087E-7,2.14131E-7,2.1122E-7,2.08355E-7,2.05534E-7,2.02756E-7,2.00022E-7,1.97329E-7,1.94678E-7,1.92067E-7,1.89497E-7,1.86965E-7,1.84473E-7,1.82018E-7,1.796E-7,1.77219E-7,1.74874E-7,1.72564E-7,1.70289E-7,1.68049E-7,1.65842E-7,1.63668E-7,1.61527E-7,1.59417E-7,1.57339E-7,1.55292E-7,1.53275E-7,1.51288E-7,1.49331E-7,1.47402E-7,1.45502E-7,1.4363E-7,1.41785E-7,1.39967E-7,1.38176E-7,1.36411E-7,1.34672E-7,1.32958E-7,1.31269E-7,1.29604E-7,1.27964E-7,1.26347E-7,1.24753E-7,1.23183E-7,1.21635E-7,1.20109E-7,1.18605E-7,1.17122E-7,1.15661E-7,1.1422E-7,1.128E-7,1.114E-7,1.1002E-7,1.08659E-7,1.07318E-7,1.05995E-7,1.04691E-7,1.03406E-7,1.02138E-7,1.00888E-7,9.96555E-8,9.84402E-8,9.72418E-8,9.60601E-8,9.48947E-8,9.37455E-8,9.26121E-8,9.14944E-8,9.03921E-8,8.93049E-8,8.82327E-8,8.71751E-8,8.6132E-8,8.51031E-8,8.40883E-8,8.30872E-8,8.20998E-8,8.11257E-8,8.01649E-8,7.9217E-8,7.82819E-8,7.73594E-8,7.64493E-8,7.55514E-8,7.46655E-8,7.37915E-8,7.29292E-8,7.20784E-8,7.12389E-8,7.04105E-8])
			beamConst=Float1d([5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.08677E-6,5.55169E-6,5.02846E-6,4.7949E-6,3.93599E-6,5.02151E-6,4.40027E-6,6.20058E-6,7.17504E-6,6.73142E-6,6.70903E-6,6.04119E-6,6.35387E-6,5.72438E-6,4.87623E-6,5.45485E-6,6.34493E-6,7.59776E-6,6.94049E-6,5.97474E-6,5.97645E-6,6.23113E-6,7.30189E-6,6.79784E-6,7.22372E-6,6.36819E-6,6.88715E-6,6.21334E-6,4.65201E-6,4.37413E-6,4.74739E-6,5.56838E-6,5.3182E-6,5.72567E-6,6.30561E-6,6.83607E-6,6.3392E-6,5.83175E-6,5.50292E-6,5.20711E-6,5.15169E-6,3.69596E-6,4.28376E-6,4.19109E-6,5.62381E-6,5.43125E-6,5.41978E-6,5.72762E-6,5.60159E-6,5.64076E-6,5.9404E-6,6.60361E-6,7.16841E-6,7.00983E-6,7.79978E-6,8.13157E-6,8.50782E-6,8.82756E-6,9.4515E-6,9.81196E-6,1.06443E-5,1.17724E-5,1.18742E-5,1.30053E-5,1.33706E-5,1.32848E-5,1.30792E-5,1.32471E-5,1.41202E-5,1.46752E-5,1.50941E-5,1.58374E-5,1.6188E-5,1.70152E-5,1.67109E-5,1.66436E-5,1.77498E-5,1.81888E-5,1.9338E-5,1.99972E-5,1.96574E-5,1.98818E-5,1.92419E-5,1.96882E-5,1.9423E-5,2.05343E-5,2.093E-5,2.04551E-5,2.03094E-5,1.98355E-5,1.99625E-5,1.98423E-5,2.05884E-5,2.13572E-5,2.02534E-5,2.02406E-5,2.00155E-5,2.06533E-5,2.10202E-5,2.02794E-5,2.03018E-5,2.0003E-5,1.97343E-5,1.92341E-5,1.88533E-5,1.9651E-5,1.99034E-5,1.97738E-5,1.97506E-5,1.96383E-5,1.97972E-5,2.09653E-5,2.03801E-5,2.04137E-5,1.89231E-5,1.83261E-5,1.96057E-5,1.9567E-5,2.12436E-5,2.12781E-5,2.11794E-5,2.03747E-5,1.88358E-5,1.81883E-5,1.82048E-5,1.77093E-5,1.77436E-5,1.59741E-5,1.53164E-5,1.44331E-5,1.36507E-5,1.34905E-5,1.31186E-5,1.40752E-5,1.44988E-5,1.37962E-5,1.2642E-5,1.11473E-5,1.12101E-5,1.12937E-5,1.00556E-5,9.48801E-6,9.30109E-6,9.72022E-6,1.00256E-5,9.51902E-6,9.97565E-6,9.16297E-6,9.57657E-6,9.89247E-6,1.04268E-5,1.10412E-5,1.0041E-5,1.08475E-5,1.09983E-5,1.0685E-5,1.07165E-5,1.11115E-5,1.13975E-5,1.16587E-5,1.22081E-5,1.19236E-5,1.22313E-5,1.27362E-5,1.31658E-5,1.32125E-5,1.32811E-5,1.27272E-5,1.25164E-5,1.26821E-5,1.32416E-5,1.31863E-5,1.29539E-5,1.29043E-5,1.32856E-5,1.40853E-5,1.41174E-5,1.41972E-5,1.41067E-5,1.3645E-5,1.38009E-5,1.34121E-5,1.37394E-5,1.24209E-5,1.10554E-5,1.01805E-5,1.00653E-5,1.09847E-5,1.12052E-5,1.15735E-5,1.10319E-5,9.93059E-6,9.47572E-6,8.82971E-6,8.55505E-6,8.5818E-6,8.98292E-6,1.04262E-5,1.04373E-5,1.03965E-5,1.03712E-5,9.85055E-6,9.73206E-6,1.0659E-5,1.12167E-5,1.24263E-5,1.26413E-5,1.32316E-5,1.33761E-5,1.4533E-5,1.48344E-5,1.51239E-5,1.45962E-5,1.45143E-5,1.37314E-5,1.39788E-5,1.39159E-5,1.33391E-5,1.27095E-5,1.1957E-5,1.19657E-5,1.17872E-5,1.14363E-5,1.09137E-5,1.0608E-5,9.42716E-6,9.41644E-6,8.7694E-6,8.62547E-6,8.70254E-6,8.53212E-6,8.63257E-6,8.38165E-6,7.80568E-6,8.20048E-6,7.31159E-6,8.61116E-6,8.51124E-6,8.8354E-6,9.12302E-6,9.19607E-6,9.48043E-6,8.43301E-6,7.58741E-6,8.44128E-6,7.86536E-6,9.10236E-6,8.78626E-6,9.67913E-6,9.19574E-6,8.77805E-6,7.75158E-6,8.30168E-6,7.83438E-6,8.00052E-6,7.19542E-6,6.59632E-6,5.88185E-6,5.091E-6,4.57348E-6,4.04813E-6,4.11935E-6,4.37767E-6,3.07287E-6,8.56604E-7,1.53576E-6,3.06528E-6,3.55928E-6,3.35785E-6,1.74082E-6,1.32127E-6,1.00748E-6,1.40341E-6,1.96235E-6,8.05367E-7])
		else:
			beamCore=Float1d([1.0,0.996651,0.989857,0.982063,0.968855,0.950125,0.928724,0.904149,0.879008,0.84853,0.815302,0.782514,0.747541,0.709445,0.668981,0.631238,0.590896,0.548272,0.507365,0.469009,0.431755,0.394156,0.355888,0.321486,0.290042,0.258151,0.228569,0.201914,0.17708,0.153646,0.13243,0.113433,0.0972841,0.0827065,0.0693352,0.0576214,0.0479977,0.0399513,0.0332838,0.0278814,0.0236538,0.0203722,0.0178637,0.0161553,0.0150278,0.0143608,0.0140309,0.0140443,0.0142671,0.014612,0.0150695,0.0154684,0.0159436,0.0162266,0.0165357,0.0167242,0.0167626,0.0167866,0.0165448,0.0163272,0.0159309,0.015388,0.0149107,0.0141684,0.0135654,0.0127659,0.0119824,0.0112542,0.0104339,0.0097059,0.00890145,0.00816564,0.00750107,0.00675696,0.00617146,0.00555615,0.00501887,0.00451223,0.0040481,0.00367607,0.00330019,0.00298444,0.00269585,0.00245924,0.00225682,0.00207569,0.00192984,0.0017938,0.00170371,0.00161582,0.00154139,0.00151487,0.00147401,0.00146237,0.00144342,0.00143662,0.00144318,0.00144695,0.00147781,0.0014918,0.00151923,0.0015375,0.00155658,0.00158949,0.00160736,0.00163117,0.00164796,0.00166784,0.00168482,0.00169033,0.00169478,0.00169294,0.00168945,0.00168355,0.00167586,0.00165711,0.00164066,0.00161416,0.00159062,0.0015691,0.00153032,0.00150093,0.00145968,0.00143042,0.00138112,0.00133653,0.0013021,0.00125293,0.00121025,0.00116104,0.00111988,0.0010877,0.00103712,0.00100197,9.5449E-4,9.15951E-4,8.82327E-4,8.35856E-4,8.01531E-4,7.57387E-4,7.28281E-4,6.88112E-4,6.59937E-4,6.31144E-4,5.96314E-4,5.72537E-4,5.33144E-4,5.07843E-4,4.84374E-4,4.61062E-4,4.38784E-4,4.1461E-4,3.94149E-4,3.78228E-4,3.56095E-4,3.39289E-4,3.21245E-4,3.09906E-4,2.99963E-4,2.88861E-4,2.78049E-4,2.65314E-4,2.56445E-4,2.458E-4,2.36747E-4,2.2916E-4,2.231E-4,2.16732E-4,2.1187E-4,2.09908E-4,2.0615E-4,2.02324E-4,1.95542E-4,1.8893E-4,1.85742E-4,1.85716E-4,1.84638E-4,1.83036E-4,1.80229E-4,1.74315E-4,1.73125E-4,1.69074E-4,1.65436E-4,1.62853E-4,1.59312E-4,1.61882E-4,1.58364E-4,1.57899E-4,1.52743E-4,1.47568E-4,1.48164E-4,1.41491E-4,1.42918E-4,1.4432E-4,1.48588E-4,1.49082E-4,1.46398E-4,1.46022E-4,1.46549E-4,1.4351E-4,1.44146E-4,1.40877E-4,1.40661E-4,1.36213E-4,1.33646E-4,1.33862E-4,1.31502E-4,1.31076E-4,1.28024E-4,1.26257E-4,1.22056E-4,1.19965E-4,1.17255E-4,1.14707E-4,1.10353E-4,1.09424E-4,1.07594E-4,1.06162E-4,1.01335E-4,9.34231E-5,8.4633E-5,7.73325E-5,7.71878E-5,7.69757E-5,7.54112E-5,7.27494E-5,7.11102E-5,6.88467E-5,6.45855E-5,6.10252E-5,5.74963E-5,5.44299E-5,4.97649E-5,4.57377E-5,4.44271E-5,4.37178E-5,4.3884E-5,4.22619E-5,4.2241E-5,4.06311E-5,3.80629E-5,3.41446E-5,3.11976E-5,3.1263E-5,3.47219E-5,3.5171E-5,3.54567E-5,3.25551E-5,3.0491E-5,2.88569E-5,2.76059E-5,2.89711E-5,2.84306E-5,2.95365E-5,3.19448E-5,3.18688E-5,3.35526E-5,2.99129E-5,2.77649E-5,2.5784E-5,2.47377E-5,2.44748E-5,2.66063E-5,2.54986E-5,2.29084E-5,2.19124E-5,1.92033E-5,2.14855E-5,1.90167E-5,1.78468E-5,1.51851E-5,1.31174E-5,1.03742E-5,7.88839E-6,8.59518E-6,8.35589E-6,9.36279E-6,9.37747E-6,7.23039E-6,8.10165E-6,6.49837E-6,7.22097E-6,6.25036E-6,6.17839E-6,5.79763E-6,5.05362E-6,6.14773E-6,5.80588E-6,4.50021E-6,5.25943E-6,3.66401E-6,7.43287E-6,8.02089E-6,9.79845E-6,1.01753E-5,8.23216E-6,1.15249E-5,8.18342E-6,1.02249E-5,9.27431E-6,8.52565E-6,9.41787E-6,6.01636E-6,8.32448E-6,8.13384E-6,1.04437E-5,1.22235E-5,1.10535E-5,1.24043E-5,8.97654E-6,9.09207E-6,8.7655E-6,1.03782E-5,1.6466E-5,1.34461E-5,1.48013E-5,1.49501E-5,1.48658E-5,1.68094E-5,1.49335E-5,1.57856E-5,1.30813E-5,1.44363E-5,1.47843E-5,1.27656E-5,1.48673E-5,1.275E-5,1.29534E-5,1.15506E-5,9.2234E-6,9.50415E-6,5.89202E-6,8.46564E-6,7.73768E-6,7.45989E-6,3.47963E-6,2.09842E-7,2.54518E-6,2.52925E-6,1.88429E-6,5.9755E-7,-2.0534E-6,-2.65986E-7,-1.4791E-6,-1.75359E-6,-1.6937E-6,-8.60163E-9,1.41119E-6,1.10432E-6,4.23688E-7,-8.90333E-7,2.13727E-7,4.20014E-7,3.17055E-7,-1.53874E-8,-2.41662E-6,-1.71964E-6,-2.51684E-6,-1.51768E-6,1.25103E-6,-2.6696E-7,7.76775E-7,2.43065E-7,5.02887E-7,2.32238E-7,-9.46365E-8,1.52217E-6,1.85426E-6,1.85932E-6,2.03807E-6,1.67212E-6,1.64082E-6,1.61019E-6,1.58022E-6,1.55088E-6,1.52216E-6,1.49405E-6,1.46652E-6,1.43958E-6,1.4132E-6,1.38737E-6,1.36208E-6,1.33732E-6,1.31307E-6,1.28932E-6,1.26606E-6,1.24328E-6,1.22096E-6,1.1991E-6,1.17769E-6,1.15672E-6,1.13617E-6,1.11603E-6,1.0963E-6,1.07697E-6,1.05803E-6,1.03947E-6,1.02128E-6,1.00345E-6,9.85981E-7,9.68855E-7,9.52068E-7,9.35613E-7,9.19482E-7,9.03669E-7,8.88165E-7,8.72964E-7,8.5806E-7,8.43447E-7,8.29117E-7,8.15064E-7,8.01283E-7,7.87768E-7,7.74512E-7,7.61511E-7,7.48759E-7,7.3625E-7,7.2398E-7,7.11942E-7,7.00133E-7,6.88547E-7,6.7718E-7,6.66027E-7,6.55083E-7,6.44344E-7,6.33806E-7,6.23464E-7,6.13315E-7,6.03354E-7,5.93578E-7,5.83982E-7,5.74563E-7,5.65318E-7,5.56242E-7,5.47332E-7,5.38585E-7,5.29997E-7,5.21565E-7,5.13287E-7,5.05158E-7,4.97176E-7,4.89338E-7,4.8164E-7,4.74081E-7,4.66657E-7,4.59366E-7,4.52204E-7,4.4517E-7,4.38261E-7,4.31474E-7,4.24806E-7,4.18257E-7,4.11822E-7,4.055E-7,3.99289E-7,3.93187E-7,3.87191E-7,3.81299E-7,3.75509E-7,3.6982E-7,3.64228E-7,3.58734E-7,3.53334E-7,3.48026E-7,3.42809E-7,3.37682E-7,3.32642E-7,3.27688E-7,3.22818E-7,3.18031E-7,3.13324E-7,3.08697E-7,3.04148E-7,2.99675E-7,2.95277E-7,2.90953E-7,2.86702E-7,2.82521E-7,2.78409E-7,2.74366E-7,2.7039E-7,2.66479E-7,2.62633E-7,2.5885E-7,2.5513E-7,2.5147E-7,2.4787E-7,2.4433E-7,2.40846E-7,2.3742E-7,2.34049E-7,2.30732E-7,2.27469E-7,2.24259E-7,2.21101E-7,2.17993E-7,2.14935E-7,2.11926E-7,2.08965E-7,2.06051E-7,2.03184E-7,2.00362E-7,1.97584E-7,1.94851E-7,1.92161E-7,1.89513E-7,1.86907E-7,1.84341E-7,1.81816E-7,1.79331E-7,1.76884E-7,1.74475E-7,1.72103E-7,1.69769E-7,1.6747E-7,1.65207E-7,1.62979E-7,1.60785E-7,1.58625E-7,1.56497E-7,1.54403E-7,1.5234E-7,1.50309E-7,1.48309E-7,1.46339E-7,1.44399E-7,1.42488E-7,1.40606E-7,1.38753E-7,1.36927E-7,1.35129E-7,1.33357E-7,1.31613E-7,1.29894E-7,1.28201E-7,1.26533E-7,1.24889E-7,1.2327E-7,1.21675E-7,1.20104E-7,1.18556E-7,1.1703E-7,1.15527E-7,1.14046E-7,1.12587E-7,1.11148E-7,1.09731E-7,1.08335E-7,1.06958E-7,1.05602E-7,1.04265E-7,1.02948E-7,1.01649E-7,1.0037E-7,9.91084E-8,9.78651E-8,9.66396E-8,9.54316E-8,9.42409E-8,9.30671E-8,9.19099E-8,9.07692E-8,8.96447E-8,8.8536E-8,8.7443E-8,8.63654E-8,8.53029E-8,8.42553E-8,8.32224E-8,8.2204E-8,8.11998E-8,8.02095E-8,7.92331E-8,7.82702E-8,7.73206E-8,7.63842E-8,7.54608E-8,7.45501E-8,7.36519E-8,7.2766E-8,7.18924E-8,7.10307E-8,7.01807E-8,6.93424E-8,6.85155E-8,6.76998E-8,6.68953E-8,6.61016E-8,6.53187E-8,6.45463E-8,6.37844E-8,6.30328E-8,6.22912E-8,6.15596E-8,6.08378E-8,6.01257E-8,5.9423E-8,5.87298E-8,5.80458E-8,5.73708E-8])
			beamConst=Float1d([1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,1.67212E-6,3.67634E-6,6.30484E-6,9.69739E-6,1.1769E-5,1.01253E-5,1.09936E-5,1.15079E-5,1.27383E-5,1.19652E-5,1.25902E-5,1.33222E-5,1.23758E-5,1.52921E-5,1.52063E-5,1.85976E-5,2.21749E-5,2.40168E-5,2.37149E-5,2.26959E-5,2.3492E-5,2.40052E-5,2.57976E-5,2.77245E-5,3.102E-5,3.09916E-5,3.12115E-5,2.96651E-5,3.02977E-5,3.26697E-5,3.21739E-5,3.46569E-5,3.57894E-5,3.90384E-5,4.11446E-5,4.14552E-5,3.98007E-5,4.09971E-5,3.92911E-5,4.0406E-5,3.9309E-5,4.02506E-5,3.92758E-5,4.16381E-5,4.15447E-5,4.1245E-5,3.91502E-5,4.06657E-5,4.09667E-5,4.16468E-5,4.27382E-5,4.09266E-5,4.33142E-5,4.47361E-5,4.68535E-5,4.53421E-5,4.25069E-5,4.07276E-5,4.007E-5,4.11028E-5,4.1092E-5,4.09305E-5,3.99155E-5,4.06215E-5,3.95915E-5,3.91175E-5,4.04226E-5,4.0182E-5,4.07652E-5,3.84478E-5,3.63773E-5,3.58696E-5,3.43302E-5,3.50255E-5,3.37596E-5,3.46571E-5,3.54534E-5,3.42476E-5,3.58812E-5,3.41471E-5,3.53349E-5,3.5854E-5,3.37378E-5,3.14039E-5,2.83949E-5,2.62543E-5,2.49628E-5,2.34613E-5,2.4053E-5,2.31816E-5,2.364E-5,2.52242E-5,2.52501E-5,2.74383E-5,2.57591E-5,2.46882E-5,2.49108E-5,2.55083E-5,2.62207E-5,2.5817E-5,2.63219E-5,2.54005E-5,2.56379E-5,2.38457E-5,2.28553E-5,2.09793E-5,2.2444E-5,2.2671E-5,2.51196E-5,2.52077E-5,2.59672E-5,2.78626E-5,3.03833E-5,2.91247E-5,3.10929E-5,3.0518E-5,3.05046E-5,2.87782E-5,2.91918E-5,2.99844E-5,2.98613E-5,2.81749E-5,2.71842E-5,2.62112E-5,2.67134E-5,2.75491E-5,2.91444E-5,2.89046E-5,2.85468E-5,2.94009E-5,2.89945E-5,2.92719E-5,2.85447E-5,2.83488E-5,2.96941E-5,2.91686E-5,2.81322E-5,2.83821E-5,2.70496E-5,2.68916E-5,2.62611E-5,2.46199E-5,2.37794E-5,2.50299E-5,2.44131E-5,2.48636E-5,2.42743E-5,2.4528E-5,2.08229E-5,2.32424E-5,2.34347E-5,2.44311E-5,2.34911E-5,2.14334E-5,2.214E-5,2.28553E-5,2.3159E-5,2.4056E-5,2.18689E-5,2.07362E-5,1.99738E-5,1.98732E-5,2.07226E-5,1.991E-5,2.1999E-5,1.92058E-5,2.10049E-5,1.8158E-5,2.10373E-5,2.10317E-5,1.81786E-5,1.58982E-5,1.35257E-5,1.5731E-5,1.72135E-5,1.99696E-5,1.98036E-5,1.84706E-5,1.9006E-5,1.66465E-5,1.46844E-5,1.45358E-5,1.3562E-5,1.52098E-5,1.55422E-5,1.45722E-5,1.53662E-5,1.6204E-5,1.79242E-5,1.81253E-5,1.75743E-5,1.72536E-5,1.58389E-5,1.78088E-5,1.87469E-5,1.82784E-5,1.70906E-5,1.656E-5,1.68024E-5,2.04079E-5,2.09502E-5,2.13845E-5,1.94854E-5,1.92948E-5,2.21391E-5,2.23005E-5,2.16725E-5,2.0508E-5,2.07133E-5,2.04274E-5,1.89518E-5,2.02458E-5,2.06814E-5,1.80652E-5,1.66749E-5,1.33994E-5,1.28964E-5,1.57766E-5,1.63085E-5,1.26246E-5,9.95838E-6,1.04463E-5,1.06356E-5,1.27503E-5,8.73593E-6,5.78989E-6,2.96234E-6,2.70576E-6,5.27202E-6,4.20809E-6])

		beamComb=Double1d(maxRad)
		for r in range(maxRad):
			beamComb[r]=max(beamCore[r],beamConst[r])

		beamBand={'Core':beamCore,'Const':beamConst,'Comb':beamComb}

		beams[band]=beamBand

	return(beams)

def getRsrfs(cal=None):
	if cal==None:
		#spireCal = SpireCalTask()
		spireCal = SpireCalTask()
		cal = spireCal(jarFile='/home/chris/dp_spire/cal/spire_cal_11_0.jar')
		print '*****'
	rsrf=cal.phot.getRsrf()
	return(rsrf)

def combBeam(beams):
	bands=['PSW','PMW','PLW']
	for band in bands:
		beams[band]['Comb']=Double1d(nrad)
		for i in range(nrad):
			beams[band]['Comb'][i]=max(beams[band]['Core'][i],beams[band]['Const'][i])

		return(beams)

def effectiveBeam(beams,bands=None,nuEff=None,rsrf=None,alpha=-1.0,gamma=0.85):
	
	if bands==None:
		bands=['PSW','PMW','PLW']
	if nuEff==None:
		nuEff={'PSW':1217.27,'PMW':867.75,'PLW':610.87} #in GHz

	effBeams=beams.copy()
	for band in bands:
		effBeams[band]['Core'][:]=0
	maxRad=max(beams['radius'])


	print '*****'
	if rsrf==None:
		spireCal = SpireCalTask()
		cal = spireCal(jarFile='/home/chris/dp_spire/cal/spire_cal_11_0.jar')
		print '*****'
		rsrf=cal.phot.getRsrf()
	nuArr=rsrf.getFrequency()
	srcSpec=(nuArr/nuEff['PSW'])**alpha
	for band in bands:
		print 'band:',band
		##set up integration of denominator
		denomArg=CubicSplineInterpolator(nuArr,Double1d(rsrf.getRsrf(band) * srcSpec))
		denomInt=TrapezoidalIntegrator(min(nuArr),max(nuArr))
		#effNuBand=nuEff[band]
		beamInt=CubicSplineInterpolator(beams['radius'],Double1d(beams[band]['Core']))
		print 'Beam interpolated'
		for r in range(beams['nrad']):
			##effective radius for range of frequencies
			radEff=beams['radius']*(nuArr/nuEff[band])**gamma
			##Can't take values greater than the max Radius
			radEff[radEff.where(radEff > maxRad)]=beamInt[maxRad]

			##interpolate 
			effBeamCore=beamInt(radEff)
			effBeamComb=beamInt(radEff)
			##comb=max(core,const)
			effBeamComb[effBeamComb.where(effBeamComb < beams[band]['Const'][r])]=beams[band]['Const']

			numArgCore=CubicSplineInterpolator(nuArr,Double1d(rsrf.getRsrf(band) * srcSpec * effBeamCore))
			numArgComb=CubicSplineInterpolator(nuArr,Double1d(rsrf.getRsrf(band) * srcSpec * effBeamComb))
			numInt=TrapezoidalIntegrator(min(nuArr),max(nuArr))
			##integrate over frequency and update main structure 
			effBeams[band]['Core'][r]=numInt.integrate(numArgCore) / denomInt.integrate(denomArg)
			effBeams[band]['Comb'][r]=numInt.integrate(numArgComb) / denomInt.integrate(denomArg)
	return(effBeams)